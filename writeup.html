<head>
    <title> COS426 Assignment 5 Cloth Simulation &mdash; Writeup</title>
    <link href="css/style.css" type="text/css" rel="stylesheet"/>
</head>

<body>
<script src="js/student.js"> </script>
<script src="js/writeup.js"> </script>
<div class="top">
<div class="main_div">

<h1> <div class=assignment>COS426 Assignment 5</div> Cloth Simulation &mdash; Writeup</h1>
<h2>Switch to: <a href='index.html'>Simulation</a></h2>
<div class='selectable'>
<h2 id='student'></h2>

<ul>
<li>(1.5) <a href='#Cloth'>Cloth</a></li>
<li>(1.5) <a href='#Constraints'>Constraints</a></li>
<li>(1.0) <a href='#Gravity'>Gravity</a></li>
<li>(1.5) <a href='#Verlet+integration'>Verlet integration</a></li>
<li>(0.5) <a href='#Floor+collision'>Floor collision</a></li>
<li>(1.5) <a href='#Sphere+collision'>Sphere collision</a></li>
<li>(1.5) <a href='#Box+collision'>Box collision</a></li>
<li>(1.0+) <a href='#Extensions'>Extensions</a></li>
<li><a href='#Collaboration'>Collaboration</a></li>
<li><a href='#Feedback'>Feedback</a></li>
</ul></div>

<p><hr><p><a name='Cloth'></a><h2>Cloth</h2><p><hr><p>
In order to add all of the springs between particles, I used for loops to run through the cloth and create constraints. I followed the explanation from the UC Irvine lectures. The structural constraints connected particles to their immediate 4 neighbors. Shear constraints connected particles to their diagonal neighbors. Lastly, the bending constraints connecting particles two away from each other. For each type of constraint, I used two for loops in order to be sure to account for edge cases in both directions. 

<p><hr><p><a name='Constraints'></a><h2>Constraints</h2><p><hr><p>
In order to enforce the constraints, I first implemented the equation for v_corr in the enforce function. I found v_12 by subtracting p2 from p1. I then found the magnitude of the vector and saved 0.5 * v_12 * (||v12|| - d) / ||v_12||. I then added this value to p1 and subtracted it from p2 in order to ensure that the points came closer together (rather than apart). After this, I wrote the enforceConstraints function, which was a for loop that called enforce on each of the saved constraints in the cloth.

<p><hr><p><a name='Gravity'></a><h2>Gravity</h2><p><hr><p>
To implement gravity, I added one line of code that added a force vector to the netForce vector in addForce. I then editted the applyGravity function. For each particle, I found the force of gravity using the formula F = ma. I made sure to make the value negative because gravity pulls in that direction! I then created a vector that only had a y component equal to gravity. Lastly, I used the addForce function to incorporate the force of gravity. 

<p><hr><p><a name='Verlet+integration'></a><h2>Verlet integration</h2><p><hr><p>
For verlet integration, I implemented the function x_t+dt=x_t+(1-D)*(x_t-x_t-dt)+a_t*(d_t)^2. First, I subtracted the previous position from the current position, then multiplied it by (1 - D). Then, I found acceleration by dividing force by mass, then I multiplied it by deltaT^2.  Lastly, I set the previous position to the current position, updated the current position by adding the current position and the other terms I found, and reset the netForce vector.

<p><b>Deliverable</b>:

<br><br><img src='results/integration.png'>

<p><hr><p><a name='Floor+collision'></a><h2>Floor collision</h2><p><hr><p>
For floor collisions, I checked the y coordinate of each particle. If the y coordinate was less than -249.0, I reset it to that value.

<p><b>Deliverable</b>: 

<br><br><img src='results/floorCollision.png'>

<p><hr><p><a name='Sphere+collision'></a><h2>Sphere collision</h2><p><hr><p>
For sphere collision, I checked if the particle was inside of the sphere by comparing the distance from the center of sphere to the radius. If it was, I projected it onto the surface of the sphere by normalizing this difference, scaling it by the size of the sphere, and adding it from the center of the sphere. I then checked if the previous position was outside of the sphere with the same method. If it was, then I updated the position using the weighted friction formula. Otherwise, I updated it to the first calculation!

<p><b>Deliverable</b>:

<br><br><img src='results/sphere.png'>

<p><hr><p><a name='Box+collision'></a><h2>Box collision</h2><p><hr><p>
I used a similar thought process as sphere collision to handle collisions with the box. I first checked if the particle was inside of the box using the Box3 containsPoint function. If it was, then I found the distance from the particle to each side of the box. I then tested each distance and set the no friction position to closest plane. Lastly, I check the location of the previous position, and incorporated friction if necessary.


<p><b>Deliverable</b>:

<br><br><img src='results/box.png'>

<p><hr><p><a name='Extensions'></a><h2>Extensions</h2><p><hr><p>
My first extension was wind! My implementation doesn't quite look like wind, but I thought it was kinda a funky movement. :) For my implementation, I added a component to the windForce vector based on each particle in the mesh's position. I multiplied the normalized position by a random scalar between positive and negative windStrength. I then added this vector to the original windForce vector.
<br>
<br>
Secondly, I added a few new textures to the mesh. The current one on display is paint.png on the floor and swirl.gif on the cloth.


<p><hr><p><a name='Collaboration'></a><h2>Collaboration</h2><p><hr><p>
I worked with Reece Schachne, Lyra Katzman, Aaron Bargotta, and Michael Popovici on this assignment!

<p><hr><p><a name='Feedback'></a><h2>[OPTIONAL] Feedback</h2><p><hr><p
<p>As you might already know, this is a brand new animation assignment for COS 426 and replaces
an older one that deals with implementing various small particle systems. You can find the
assignment from last year <a href="https://www.cs.princeton.edu/courses/archive/spring18/cos426/assign/A5/">
here</a>.

<p>We don't expect an assignment to go perfectly smoothly in its debut semester, so we would
greatly appreciate any feedback you can give us about your experience working on this assignment.
For example, approximately how many hours did you spend on it?
What parts were the most difficult or confusing to work through?
Do you have any suggestions on how to improve this assignment for the future?

<p>Thank you for your feedback! Please write below:
<br><hr>

<p>My feedback: Honestly I really liked this assignment! I thought it went really well and don't have any complaints/nothing went wrong. The instructions were clear and overall, the assignment took me more or less 10 hours. Also, I'm so sorry Austin for my silly question about textures. :)

</div>
</div>
</body>
</html>
